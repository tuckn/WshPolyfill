var describe,test,expect,jest={};!function(){var _description,_skippedCount,_passedCount,_faledCount,_expectedCount,ANYTHING_OBJ={matching:"null/undefined"},_reTestName=function(){if(0<WScript.Arguments.length)for(var arg,matched,reTestPtn=new RegExp("^(-t|--testNamePattern)=(.+)$"),i=0,I=WScript.Arguments.length;i<I;i++){if(arg=String(WScript.Arguments(i)),reTestPtn.test(arg))return matched=arg.match(reTestPtn),new RegExp(matched[2]);if("-t"===arg||"--testNamePattern"===arg)return new RegExp(String(WScript.Arguments(i+1)))}}();jest._protoTypeOf=function(val){return val===undefined?"undefined":null===val?"null":Object.prototype.toString.call(val).slice(8,-1)};var _protoTypeOf=jest._protoTypeOf;jest._toDir=function(val,indent){var i,I,p,newIndent="  "+(indent=indent||""),type=_protoTypeOf(val),r="";if("undefined"===type||"null"===type)r=type;else if(!0===val)r="true";else if(!1===val)r="false";else if(val===Infinity)r="Infinity";else if("unknown"==typeof val)r=val;else if("String"===type)r='"'+val+'"';else if("Number"===type)r=isNaN(val)?"NaN":String(val);else if("Object"===type){for(p in r="{\n",Object(val))r+=newIndent+p+": "+_toDir(val[p],newIndent)+",\n";r=r.replace(/,\n$/,"\n"),r+=indent+"}"}else if("Array"===type){for(r="[\n",i=0,I=val.length;i<I;i++)r+=newIndent+i+": "+_toDir(val[i],newIndent)+",\n";r=r.replace(/,\n$/,"\n"),r+=indent+"]"}else"Error"===type?(r=(val.name?String(val.name):"Error")+": ",r+="["+(val.number?String(val.number):"")+"] ",r+=val.message?val.message:""):r=String(val);return r};var _toDir=jest._toDir;jest._contains=function(collection,target){var typeObjA=_protoTypeOf(collection);if(target===ANYTHING_OBJ&&collection!==undefined&&null!==collection)return!0;if("String"===typeObjA)return-1!==collection.indexOf(target);if("Array"===typeObjA)for(var i=0,len=collection.length;i<len;i++){if(target===ANYTHING_OBJ&&collection[i]!==undefined&&null!==collection[i])return!0;if(collection[i]===target)return!0}return!1},jest._containsEqual=function(collection,target){var val;if("Array"===_protoTypeOf(collection))for(var i=0,len=collection.length;i<len;i++)if(val=collection[i],"Array"===_protoTypeOf(val)||"Object"===_protoTypeOf(val)){if(jest._equal(val,target))return!0}else{if(target===ANYTHING_OBJ&&val!==undefined&&null!==val)return!0;if(val===target)return!0}return!1},jest._equal=function(valA,valB){if(valA===valB)return!0;if(valB===ANYTHING_OBJ&&valA!==undefined&&null!==valA)return!0;var typeValA=_protoTypeOf(valA),typeValB=_protoTypeOf(valB);if("Array"!==typeValA&&"Object"!==typeValA)return!1;if("Array"===typeValA||"Array"===typeValB){if("Array"!==typeValA||"Array"!==typeValB)return!1;var lenA=valA.length,lenB=valB.length;if(lenA!==lenB)return!1;if(0===lenA&&0===lenB)return!0;for(var i=0;i<lenA;i++)if(!jest._equal(valA[i],valB[i]))return!1}if("Object"===typeValA||"Object"===typeValB){if("Object"!==typeValA||"Object"!==typeValB)return!1;for(var propName in valA)if(Object.prototype.hasOwnProperty.call(valA,propName)&&!jest._equal(valA[propName],valB[propName]))return!1}return!0},WScript.Echo(String(WScript.ScriptFullName)),describe=function(description,fn){_description=description,_faledCount=_passedCount=_skippedCount=0,WScript.Echo("\n----------------------------\n"+description),fn();var resultMsg="\nTests: ",totalCount=_skippedCount+_passedCount+_faledCount;0!==_skippedCount&&(resultMsg+=_skippedCount+" skipped, "),0!==_passedCount&&(resultMsg+=_passedCount+" passed, "),WScript.Echo(resultMsg+totalCount+" total")};var Test=function(name,fn){if(!_reTestName||_reTestName.test(_description+name)){var startTime,msec;_expectedCount=0;try{startTime=new Date,fn(),msec=(new Date).getTime()-startTime.getTime(),WScript.Echo("  √ "+name+" ("+msec+"ms "+_expectedCount+"exp)"),_passedCount+=1}catch(e){msec=(new Date).getTime()-startTime.getTime(),WScript.Echo("  × "+name+" ("+msec+"ms "+(_expectedCount-1)+"exp)"),WScript.Echo("      No."+_expectedCount+" "+String(e.message)),_faledCount+=1}}else _skippedCount+=1};(test=function(name,fn){return new Test(name,fn)}).skip=function(received){_skippedCount+=1};var Expect=function(received){this.not={},this.arrayContaining=function(expected){},this.not.arrayContaining=function(expected){},this.toBe=function(expected){if(received!==expected)throw new Error("Expected to be "+expected+", but "+_toDir(received))},this.not.toBe=function(expected){if(received===expected)throw new Error("Expected not to be "+expected+", but "+_toDir(received))},this.toBeNaN=function(){if(received==received)throw new Error},this.not.toBeNaN=function(){if(received!=received)throw new Error},this.toBeGreaterThan=function(expected){if(!(expected<received))throw new Error("Expected to be greater than "+expected+", but "+received)},this.toBeGreaterThanOrEqual=function(expected){if(!(expected<=received))throw new Error("Expected to be equal or greater than "+expected+", but "+received)},this.toBeLessThanOrEqual=function(expected){if(!(received<=expected))throw new Error("Expected to be equal or less than "+expected+", but "+received)},this.toBeLessThan=function(expected){if(!(received<expected))throw new Error("Expected to be less than "+expected+", but "+received)},this.toBeNull=function(){if(null!==received)throw new Error},this.not.toBeNull=function(){if(null===received)throw new Error},this.toBeTruthy=function(){if(1!=received)throw new Error},this.toBeFalsy=function(){if(0!=received)throw new Error},this.toBeUndefined=function(){if(received!==undefined)throw new Error("Expected to be undefined, But defined. "+_toDir(received))},this.toBeDefined=function(){if(received===undefined)throw new Error("Expected not to be undefined, But undefined.")},this.toContain=function(item){if(received===undefined||null===received)throw new Error("\nexpect(received).toContain(expected)\nMatcher error: received value must not be null nor undefined\nReceived has value: "+_toDir(received));if(!jest._contains(received,item))throw new Error("Expected to contain "+_toDir(item)+" in "+_toDir(received)+". but is not contained.")},this.not.toContain=function(item){if(received===undefined||null===received)throw new Error("\nexpect(received).toContain(expected)\nMatcher error: received value must not be null nor undefined\nReceived has value: "+_toDir(received));if(jest._contains(received,item))throw new Error("Expected to not contain "+_toDir(item)+" in "+_toDir(received)+". but is contained.")},this.toContainEqual=function(item){if(!jest._containsEqual(received,item))throw new Error("Expected to contain "+_toDir(item)+" in "+_toDir(received)+". but is not contained.")},this.not.toContainEqual=function(item){if(jest._containsEqual(received,item))throw new Error("Expected to not contain "+_toDir(item)+" in "+_toDir(received)+". but is contained.")},this.toEqual=function(expected){if(!jest._equal(received,expected))throw new Error("Expected to be "+_toDir(expected)+", but "+_toDir(received))},this.not.toEqual=function(expected){if(jest._equal(received,expected))throw new Error("Expected to be not "+_toDir(expected)+", but "+_toDir(received))},this.toHaveLength=function(expected){var len=received.length;if(len!==expected)throw new Error("Expected to have "+expected+" length, but "+len)},this.not.toHaveLength=function(expected){var len=received.length;if(len===expected)throw new Error("Expected to not have "+expected+" length, but "+len)},this.toMatch=function(regexpObj){if(!regexpObj.test(received))throw new Error("Expected to be "+_toDir(regexpObj)+", but "+_toDir(received))},this.not.toMatch=function(regexpObj){if(regexpObj.test(received))throw new Error("Expected to be not "+_toDir(regexpObj)+", but "+_toDir(received))},this.objectContaining=function(expected){},this.not.objectContaining=function(expected){},this.toThrowError=function(){var errMsg="Expected throwing a error, but not did";try{throw received(),new Error(errMsg)}catch(e){if(errMsg===e.message)throw new Error(errMsg)}},this.toThrow=function(){this.toThrowError()}};(expect=function(received){return _expectedCount+=1,new Expect(received)}).anything=function(){return ANYTHING_OBJ}}();
